<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.ilabservice.intelab.mapper.LoginUserMapper">

	<!-- 可根据自己的需求，是否要使用 -->
    <resultMap type="com.ilabservice.intelab.model.LoginUser" id="loginUserMap">
        <result property="id" column="id"/>
        <result property="companyId" column="company_id"/>
        <result property="userName" column="user_name"/>
        <result property="password" column="password"/>
        <result property="name" column="name"/>
        <result property="headIcon" column="head_icon"/>
        <result property="mobile" column="mobile"/>
        <result property="telephone" column="telephone"/>
        <result property="gender" column="gender"/>
        <result property="email" column="email"/>
        <result property="department" column="department"/>
        <result property="job" column="job"/>
        <result property="jobNumber" column="job_number"/>
        <result property="bindMobile" column="bind_mobile"/>
        <result property="bindEmail" column="bind_email"/>
        <result property="verify" column="verify"/>
        <result property="createDatetime" column="create_datetime"/>
        <result property="updateDatetime" column="update_datetime"/>
        <result property="lastPasswordErrorDate" column="last_password_error_date"/>
        <result property="passwordErrorRetryTimes" column="password_error_retry_times"/>
        <result property="latestPasswordUpdateTime" column="latest_password_update_time"/>
        <result property="alertNotificationType" column="alert_notification_type"/>
        <result property="blockChainAddress" column="block_chain_address"/>
    </resultMap>

    <select id="listAllRolesByUserid" parameterType="Integer"
        resultType="com.ilabservice.intelab.model.Roles">
        SELECT
            rd.id,
            rd.`name` AS roleName,
            rd.role_type AS roleType,
            rd.description AS roleDesc
        FROM
            role_definition rd
        LEFT JOIN site_role_user_map srum ON rd.id = srum.role_id
        WHERE srum.user_id = #{userID}
    </select>

    <select id="listAllPermissionsByRoleid" parameterType="Integer"
            resultType="com.ilabservice.intelab.model.Permissions">
        SELECT
            `p`.`name` AS `permissionName`,
            `p`.`permission_type` AS `permissionType`,
            `p`.`description` AS `permissionDesc`
        FROM
            permission p
        LEFT JOIN role_permission_map rpm ON p.id = rpm.permission_id
        WHERE rpm.role_id = #{roleid}
    </select>

</mapper>